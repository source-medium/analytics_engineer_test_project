version: 2

models:
  - name: staging_acme_recharge_subscriptions
    description: table containing casted data from raw source

    columns:
      - name: primary_key
        description: hashed out version of the transaction_id column
        tests:
          - unique
          - not_null

      - name: transaction_id
        description: "{{ doc('transaction_id') }}"
        tests:
          - unique
          - not_null

      - name: customer_id
        description: "{{ doc('customer_id') }}"
        tests:
          - not_null

      - name: subscription_sku
        description: the sku number of a given subscription

      - name: customer_email
        description: the email associated with a customer
        tests:
          - not_null

      - name: subscription_title
        description: the human readable name for a subscription

      - name: subscription_price
        description: the price of a subscription

      - name: is_subscription_cancelled
        description: boolean value for if a subscription has been cancelled
        tests:
          - not_null

      - name: is_subscription_active
        description: boolean value for if a subscription is active
        tests:
          - not_null

      - name: quantity
        description: the number purchased

      - name: created_at
        description: "{{ doc('created_at') }}"

      - name: is_subscription_prepaid
        description: boolean value for if a subscription has been prepaid
        tests:
          - not_null

      - name: cancelled_at
        description: "{{ doc('cancelled_at') }}"
        tests:

      - name: order_day_of_week
        description: day of the week in which an order was created

      - name: has_queued_charges
        description: boolean value describing if a subscription has charges in a queue


      - name: order_day_of_month
        description: day of the month in which an order was created

      - name: cancellation_reason
        description: string value for the reason behind a cancellation

      - name: max_retries_reached
        description: number of times that a charge can be retried for a transaction

      - name: order_interval_unit
        description: string that captures the cadence in which a subscription is renewed

      - name: next_charge_scheduled_at
        description: next date that a charge is scheduled to occur for a subscription

      - name: order_interval_frequency
        description: how frequently orders are replaced

      - name: charge_interval_frequency
        description: how frequently charges are made for a given subscription

      - name: cancellation_reason_comments
        description: string that captures additional cancellation reasons

      - name: expire_after_specific_number_of_charges
        description: timebox for when a subscription should expire based on the number of charges that have occurred.
